<div class="window" style="padding-top: 1.5rem;">
  <div class="window-content">
    <div class="pane-group">
	  	<div class="pane" style="padding:4rem;padding-top: 0 ">
			<div class="show-flex noprint">	
				<button id="help" class="btn btn-default ml-auto header-tab mb-1">
      			<span style="color:#4e5851;" class="icon icon-lifebuoy icon-text"></span> <strong>Help</strong>
    </button>
		</div>

			<h3 class="text-center"><u><span class="icon icon icon-code icon-text" style="color:#4e5851;padding-right:1rem "></span>Advanced Queries</u></h3>
			<table style="background-color: transparent;width: 50%;margin-left:22%; " class= "mb-2">
				<thead style="background-color: transparent;border-bottom: 0px;">
				<tr style="background-color: transparent;border-bottom: 0px">
					<th colspan="3" style="border-bottom: 0px"><input type="search" class="modern_search" name="query" id="query"></th>
					<th style="width:4rem;border-bottom: 0px">
        				<span style="font-size: 1.5rem" id="run" class="icon icon-search"></span></th>
				</tr>
			</thead>
			</table>
			<div class ="row" style="display: flex" id='display_body'>
				

			</div>

			
			<div id="notify1" style="display:none">
			<div style="padding: 15px;margin: 10px;border-radius: 8px;background-color: #ced6e0; transition:1s;">
        	<p style="margin: 0;padding: 0;color: #fff;font-weight: 300;" ><span class="icon icon-attention icon-text"></span>  <span style=" font-weight: 600 !important;">Oops!</span> Something is wrong with your query</p>
      		</div>
      		</div>

			<div id="notify2" style="display:none">
			<div style="padding: 15px;margin: 10px;border-radius: 8px;background-color: #ced6e0; transition:1s;">
        	<p style="margin: 0;padding: 0;color: #fff;font-weight: 300;" ><span class="icon icon-alert"></span>  <span style=" font-weight: 600 !important;">Sorry!</span> Didn't find anything</p>
      		</div>
      		</div>


      		<div class ="row selectable-text" style="display: none" id='display_body2'>
      				<div class="col-md-12">
      				<h3><strong>Database Tables</strong></h3>	
      				</div>
      				<div class="col-sm-6">
      					<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> desktops</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
						++id, region, department, pc_model, pc_serial, monitor_model, monitor_serial, ip,keyboard, mouse,comp_name, os, os_status, processor, ram, ms_office, ms_status, rem_storage, printer_model, printer_serial, printer_ip, scanner_model, scanner_serial, ups_model, tech_name, date, log
						</p>
						
						<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> servers</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
						++id, region, department, pc_model, pc_serial, monitor_model, monitor_serial, ip, keyboard, mouse, comp_name, os, os_status, processor, ram, ms_office, ms_status, rem_storage, ups_model, tech_name, date, log
						</p>

						<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> accesspoints</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
						++id, region, department, ap_model, ap_serial, ip, ups_model, tech_name, date, log
						</p>

						<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> extras</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
						++id, region, department, device_name, device_model, device_serial, ip,tech_name, date, log
						</p>
						


      				</div>
      				<div class="col-sm-6 selectable-text">
      					<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> laptops</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
							++id, region, department, pc_model, pc_serial, keyboard, mouse, comp_name, os, os_status, processor, ram, ms_office, ms_status, ip, rem_storage, printer_model, printer_serial, printer_ip, scanner_model, scanner_serial, tech_name, date, log
						</p>
      				<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> routers</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
							++id, region, department, router_model, router_serial, ip, ups_model, tech_name, date
						</p>

						<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong> printers</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
						++id, region, department, printer_model, printer_serial, ip, tech_name, date,log
					</p>

					<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong> Table:</strong>dvrs</h4>
						<p style="overflow-wrap: break-word;-webkit-user-select: text;">
						++id, region, department, type, channels, model, serial, ip, storage, tech_name, date
						</p>

      				</div>
      			<div class="col-md-12">
      				<h3><strong>Where Clauses</strong></h3>	
      				</div>
				<div class="col-sm-6">
      					<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong><u> Examples:</u></strong></h4>
      					<div style="overflow-wrap: break-word;-webkit-user-select: text;">
      						
      						<ul>
      							<li><strong style="overflow-wrap: break-word;-webkit-user-select: text;">desktops.where('department').equalsIgnoreCase('left_wing_department')</strong></li>
								
								<li><strong style="overflow-wrap: break-word;-webkit-user-select: text;">laptops.where('department').startsWithIgnoreCase('lef')</strong></li>

								<li><strong style="overflow-wrap: break-word;-webkit-user-select: text;">dvrs.where('type').equalsIgnoreCase('nvr')</strong></li>
      						</ul>
							
							<h4><span class="icon icon-link icon-text icon-close-tab"></span> Methods</h4>
							<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">above()</strong><br>
							Returns a collection of objects where index is above given key
							</p>
							<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">aboveOrEqual()</strong><br>
							Returns a collection of objects where index is above or equal given key</p>

							<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">anyOf()</strong><br>
							Returns a collection of objects where index is equal to any of the keys in given array</p>
							<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">anyOfIgnoreCase()</strong><br>
							Returns a collection of objects where index matches any of given strings, ignoring case differences.</p>

							<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">below()</strong><br>
							Returns a collection of objects where index is below given key</p>
					<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">belowOrEqual()</strong><br>
						Returns a collection of objects where index is below or equal given key</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">between()</strong><br>
						Returns a collection of objects where index is between given boundaries</p>
      						

      					</div>
      			</div>
				<div class="col-sm-6">
				<div style="overflow-wrap: break-word;-webkit-user-select: text;">

				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">equals()</strong><br>
						Returns a collection of objects where index equals given key</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">equalsIgnoreCase()</strong><br>
						Returns a collection of objects where index equals given string-key ignoring case differences</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">inAnyRange()</strong><br>
						Returns a collection where index is within any of the given ranges.</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">noneOf()</strong><br>
						Returns a collection where index equals anything but any of the keys in given array</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">notEqual()</strong><br>
						Returns a collection where index equals anything but given value</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">startsWith()</strong><br>
						Returns a collection of objects where index starts with given string-key</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">startsWithAnyOf()</strong><br>
						Returns a collection of objects where index starts with any of the given strings</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">startsWithIgnoreCase()</strong><br>
						Returns a collection of objects where index starts with given string-key ignoring case differences</p>
				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">startsWithAnyOfIgnoreCase()</strong><br>
						Returns a collection of objects where index starts with any of given strings, ignoring case differences</p>
				</div>
				</div>
				
				<div class="col-md-12">
      				<h3><strong>Others</strong></h3>	
      				</div>
      			<div class="col-sm-6">
      				<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">reverse()</strong><br>
						No matter if using sortBy() or natural sort order (orderBy or a where() clause), this method will reverse the sort order of the collection.</p>
						<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">sortBy()</strong><br>
						No matter if using sortBy() or natural sort order (orderBy or a where() clause), this method will reverse the sort order of the collection.</p>
						<p style="overflow-wrap: break-word;"><strong style="-webkit-user-select: text;">orderBy()</strong><br>
						Return a collection of all items in table where the property is set to an indexable type ordered by given indexed property.</p>
      			

      			</div>

				<div class="col-sm-6">
					<h4><span class="icon icon-link icon-text icon-close-tab"></span><strong><u> Examples:</u></strong></h4>
      					<div style="overflow-wrap: break-word;-webkit-user-select: text;">
      						
      						<ul>
      							<li><strong style="overflow-wrap: break-word;-webkit-user-select: text;">desktops.where('id').above(25).reverse() .sortBy('comp_name')</strong></li>
								
								<li><strong style="overflow-wrap: break-word;-webkit-user-select: text;">desktops.where('id').above(25).orderBy('comp_name')</strong></li>
								<li><strong style="overflow-wrap: break-word;-webkit-user-select: text;">desktops.orderBy('comp_name')</strong></li>
      						</ul>
      					</div>

      			
      			</div>	
     
			</div>
			
		</div>
	</div>
</div>
</div>
<script type="text/javascript">
document.querySelector('#query').value=stateQuery;
document.querySelector('#notify1').addEventListener("click", function(){
document.querySelector('#notify1').setAttribute('style','display:none'); 
});
document.querySelector('#notify2').addEventListener("click", function(){
document.querySelector('#notify2').setAttribute('style','display:none'); 
});
document.querySelector('#run').addEventListener("click", function(){
const { init_data} = require('../res/reusable');
var db = init_data(Dexie);
let torun = document.querySelector('#query').value;
stateQuery=torun;
if(torun){
try{
const query =eval(`db.${torun}`);
query.count()
 		.then((value)=>{
 			if(value!=0){
 				document.querySelector('#notify1').setAttribute('style','display:none');
 				document.querySelector('#notify2').setAttribute('style','display:none');
 				let display = document.getElementById('display_body');
							display.innerHTML='';
							document.querySelector('#notify1').setAttribute('style','display:none')     
							let fragment = document.createDocumentFragment();   
							query.each(computer=>{
							let wrapper = document.createElement('div');
							wrapper.setAttribute('class','col-md-4');

							let card = document.createElement('div');
							card.setAttribute('style','border:1px solid silver;border-radius:0.5rem;box-shadow: 1px 1px 0.3rem rgba(0,0,0,0.3)');
							card.setAttribute('class','card m-3 pt-0 p-2');
							//handle double clicks

							let newarr=torun.split('.');
							if(newarr[0]=='laptops'||newarr[0]=='desktops' || newarr[0]=='servers' || newarr[0]=='routers' || newarr[0]=='accesspoints' || newarr[0]=='printers' || newarr[0]=='extras' || newarr[0]=='switches' || newarr[0]=='firewalls' || newarr[0]=='phones' || newarr[0]=='tablets'){
							card.ondblclick = event => {
								window.data = computer;
								//new Tabs('./pages/edit.htm');
								Tabs('.header-tab','main','./mainview/edit-cons/'+newarr[0]+'.htm').then(()=>{
								document.querySelector('#edit_tab').style.display = 'block';	
								})
								
							}
							} else{
								card.ondblclick = event => {
								window.dvr_id = computer['id'];
								Tabs('.header-tab','main','./mainview/edit-cons/cameras.htm').then(()=>{
								document.querySelector('#edit_tab').style.display = 'block';	
								});
								
							}
							}
							// let card_head = document.createElement('h4');
							// card_head.setAttribute('class', ' pl-2 mt-0 toolbar toolbar-header');
							// card_head.setAttribute('style','border:1px solid silver;border-radius:10px;box-shadow: 2px 2px 0.5rem rgba(0,0,0,0.5)');
							// let bold = document.createElement('strong');
							// bold.innerHTML = computer['comp_name'];
							// card_head.appendChild(bold);
							// card.appendChild(card_head);






							let card_body = document.createElement('div');
							card_body.setAttribute('class','card-body p-0');
							let list = document.createElement('ul');
							list.setAttribute('class',' row m-0 p-0');
							list.setAttribute('style', 'list-style: none;');
							let innerfrag = document.createDocumentFragment();

							i = 0;
							for (const key of Object.keys(computer)) {
								if(computer[key]){
								if(key =='id' || key=='__proto__'){continue}
								else if(key == 'log'){
								let list_element = document.createElement('li');
								list_element.setAttribute('class', 'col-sm-10 m-0 p-0');
								list_element.innerHTML = `<strong>${key}</strong> : <br><pre style='color: #7fba00'>${computer[key]}</pre`;
								innerfrag.appendChild(list_element); 
								i++;
								}else{
								let list_element = document.createElement('li');
								list_element.setAttribute('class', 'col-6 m-0 p-0');
								list_element.innerHTML = ` <strong>${key}</strong> : ${computer[key]}`;
								innerfrag.appendChild(list_element);
								i++;
								}	
							}else{
								i++;
							}
							}
							list.appendChild(innerfrag);
							card_body.appendChild(list);
							card.appendChild(card_body);
							wrapper.appendChild(card);
							fragment.appendChild(wrapper);
							}).then(()=>{
							let dispOne=document.querySelector('#display_body');
							let dispTwo=document.querySelector('#display_body2');
							dispOne.setAttribute('style','display:flex');
 							dispTwo.setAttribute('style','display:none');
 							document.querySelector('#help').innerHTML=`<span style="color:#4e5851;" class="icon icon-lifebuoy icon-text"></span> <strong>Help</strong>`	
							display.appendChild(fragment);
							});


 			}else{
		document.getElementById('display_body').innerHTML='';
document.querySelector('#notify1').setAttribute('style','display:none')  		
document.querySelector('#notify2').setAttribute('style','display:block')
 			}
 		
 		});

										
}catch(err){
	document.getElementById('display_body').innerHTML='';
	document.querySelector('#notify2').setAttribute('style','display:none');  
	document.querySelector('#notify1').setAttribute('style','display:block');  
				}


}else{
	document.querySelector('#query').focus();
}


});


//Button toggle
let btnHelp=document.querySelector('#help');
let dispOne=document.querySelector('#display_body');
let dispTwo=document.querySelector('#display_body2');
btnHelp.addEventListener("click", function(){
 if(dispOne.style.display === 'flex' && dispTwo.style.display=='none'){
 	dispOne.setAttribute('style','display:none');
 	dispTwo.setAttribute('style','display:flex');
 	btnHelp.innerHTML=`<span style="color:#ee7762;" class="icon icon-lifebuoy icon-text"></span> <strong>Help</strong>`
 	//sweden.setAttribute('style','color:#ee7762');
 	
 }else{
 	dispOne.setAttribute('style','display:flex');
 	dispTwo.setAttribute('style','display:none');
 	btnHelp.innerHTML=`<span style="color:#4e5851;" class="icon icon-lifebuoy icon-text"></span> <strong>Help</strong>`
 } 
});



</script>